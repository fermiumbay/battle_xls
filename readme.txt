--------------------------------------------------
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　
　◇　　戦闘アニメ・エクセル相互変換ツール 　　◇　
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　
--------------------------------------------------
【このモジュールについて】

ダウンロードいただき、ありがとうございました。
このツールは、RPGツクール2000における戦闘アニメを
エクセルを使って編集するために、相互変換するものです。

ツクールの編集画面で作成しづらい部分を
エクセルに置き換えてエクセルで作成し、
ツクールに逆変換すれば、制作の効率化が望めます。

また、エクセルのファイルとして戦闘アニメデータを
保存しておけば、管理がしやすく、一部のアニメの
流用などをすることにも利用できます。

----------------------------------------------------------------------

【同梱内容】

『battle_xls.exe』　…　戦闘アニメ作成機実行ファイル
『hspext.dll』　…　実行ファイル起動に必要なDLLファイル
『戦闘アニメ_エクセル相互変換.hsp』　…　実行ファイルのソースファイル
『readme.txt』　…　説明書


----------------------------------------------------------------------

【利用方法】

同梱の『battle_xls.exe』を実行すると、ウィンドウが表示されます。
変換したいデータをクリップボードにコピーした上で、変換ボタンを押すと、
変換後のデータがクリップボードにコピーされます。

ただ、最近のWindowsはセキュリティ強化により、
プログラムが実行出来ないようになっている可能性があります。
処理の内容に関わらず、どうも作成者不明のプログラムとのことで
危険なプログラムかもしれないとのことで、信用されてないみたいです……
（個人でツール制作されている方は、このへんどうされているんでしょうか）
変なことをする処理は全く入っていないので安心していただきたいのですけど、
一応実行ファイルのソースファイルを同梱しておりますので、
不安な方は内容を確認いただき、HSPをインストールしてコンパイルして
実行ファイルを生成してください。

----------------------------------------------------------------------

【ツクール → エクセル 変換】

RPGツクールの戦闘アニメ画面から、戦闘アニメのデータをエクセルのデータに変換します。
ツクール2000で戦闘アニメを開き、戦闘アニメ一覧の中から、変換したい戦闘アニメを
右クリックしてコピーしてください。
その後、本ツールで「ツクール → エクセル 変換」を選択すると、
エクセル用のテキストデータに変換されてクリップボードに自動コピーされます。

エクセルを起動して、すべてを選択し、貼り付けをしてください。
セルA1に【戦闘アニメ情報】が来ていればOKです。
戦闘アニメの情報が各セルに格納されていることが確認できます。

※ 2000で取り扱う99フレームまでの戦闘アニメデータであれば
　 特に問題ないと思いますが、100フレーム以上の
　 非常に巨大な戦闘アニメデータの場合は、
　 変換に失敗する（途中までしかコピーされない）場合があります。
　 クリップボードにコピーできるサイズを制限しているためですが、
　 多発する場合はご連絡ください。
　 一応、ソースファイルでクリップボードのサイズを変更してやれば
　 応急処置で動かすことは可能だと思います。

----------------------------------------------------------------------

【エクセル → ツクール 変換】

エクセルで編集した戦闘アニメデータを、RPGツクールの戦闘アニメとして逆変換します。
前述の方法でエクセルに戦闘アニメデータを貼り付けたあと、
エクセルから戦闘アニメのデータを編集します。
編集後、エクセル上ですべて選択してコピーし、
本ツールで「エクセル → ツクール 変換」を選択すると、
ツクールの戦闘アニメのデータとして変換されてクリップボードにコピーされます。
RPGツクール2000の戦闘アニメ画面を開き、一覧のどこか空いている所で
右クリック→貼り付けをすると、出来上がった戦闘アニメが貼り付けられます。

----------------------------------------------------------------------

【エクセル編集方法の詳細】

基本的には表に項目を追加していくだけで作ることができます。
ただ、例えば【戦闘アニメ情報】や【効果音とフラッシュのタイミング】というセルは
見やすくするために置いているだけで、実際の効果は何もありません。
戦闘アニメの名前を指定する「名前:」や、
戦闘アニメの効果音を設定する「効果音名」などのセルを
判定基準として、表を解釈してデータの変換を行っています。
行・列の先頭項目のみ揃えていれば、自由に表を編成可能です。
ただし、「ﾌﾚｰﾑID」の項目はA列（一番左の列）に一つ以上記述してください。
その項目があった所を起点として、右側の項目を調べていくようになっています。

また、戦闘アニメ本体のセル配置については次のようなルールになっています。
同じフレームIDに複数の項目（「ﾊﾟﾀｰﾝID」や「座標x」など）があった場合は、
格納している順番のセルのパラメータを設定します。
例えば、同じフレームIDで「ﾊﾟﾀｰﾝID＝1」「座標x＝50」「座標x＝80」とすると
1番目のセルは「ﾊﾟﾀｰﾝID＝1」「座標x＝50」
2番目のセルは「ﾊﾟﾀｰﾝID＝(未指定)」「座標x＝80」
という状態になります。未指定の部分は何かしらのデフォルト値が入ります。
セルを順番に設定していくのではなく、
セルの「パラメータ」を順番に設定していく要領で設置します。
何故そんなルールにしているかというと、表を分離して作成しやすくするためです。
座標のみの表、色調のみの表、などを作り、パラメータ項目の設定順に記述できます。
表の分離は特に必要ないのですが、すべてのパラメータを並べると
どうしても横に長くなってしまっていたので、苦肉の策でもあります……

効果音とフラッシュのタイミングについては、以下の項目を起点とするので
その項目が無ければそれらは生成されません。（省略不可の項目です）
効果音：「効果音名」
フラッシュ：「ﾌﾗｯｼｭ対象」

----------------------------------------------------------------------

【更新履歴】

ver 1.00　（2017/12/4）：　完成


----------------------------------------------------------------------

【謝辞】

本ツールを制作する上で、イノビア様のクリップボード貼り付けモジュールを
使わせていただいています。ありがとうございました。

『ひねくれソフト工房』
http://homepage2.nifty.com/MJHS/

----------------------------------------------------------------------

　　　　　　　　　　　　　　　　　　　2017年12月4日　フェルミウム湾
